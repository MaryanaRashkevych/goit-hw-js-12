{"version":3,"file":"commonHelpers.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["import { refs } from \"../main\";\n\nfunction imageTemplate(obj){\n  const {largeImageURL, webformatURL, tags, likes, views, comments, downloads } = obj;\nreturn `<li class=\"gallery-item\">\n          <a href=\"${largeImageURL}\">\n            <img src=\"${webformatURL}\" alt=\"${tags}\" width=\"360\" height=\"200\" loading =\"lazy\"/>\n            <div class=\"text-content-box\">\n                <p class=\"image-text\"><span class=\"image-title\">Likes</span> ${likes}</p>\n                <p class=\"image-text\"><span class=\"image-title\">Views</span> ${views}</p>\n                <p class=\"image-text\"><span class=\"image-title\">Comments</span> ${comments}</p>\n                <p class=\"image-text\"><span class=\"image-title\">Downloads</span> ${downloads}</p>\n            </div>\n        </a>\n      </li>`\n};\n\n function imagesTemplate(arr){\nreturn arr.map(imageTemplate).join('');\n};\n\nexport function renderImages(arr){\n  const markup = imagesTemplate(arr);\n  refs.imagesContainer.insertAdjacentHTML('beforeend', markup);\n};\n","import axios from 'axios';\n\n\nexport async function getImages(query,currentPage){\n  const BASE_URL = 'https://pixabay.com/api/';\n  const url = BASE_URL;\n\n  const params= {\n    key: '43036736-59573289802154025d43bab67',\n    q: query,\n    lang: 'en',\n    per_page: 15,\n    page: currentPage,\n\n  };\n  const apiRes = await axios.get(url,{params});\n  return apiRes.data;\n};\n\n","import { renderImages } from './js/render-functions';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { getImages } from './js/pixabay-api';\n\nlet query;\nlet currentPage = 1;\nlet maxPage = 0;\nconst pageSize = 15;\n\nexport const refs = {\n  searchForm: document.querySelector('.js-search-form'),\n  btnShowMore: document.querySelector('.btn-show-more'),\n  imagesContainer: document.querySelector('.js-images-container'),\n  loader: document.querySelector('.loader'),\n};\n\nrefs.searchForm.addEventListener('submit', onFormSubmit);\n\nasync function onFormSubmit(e) {\n  e.preventDefault();\n  query = e.target.elements.query.value.trim();\n  refs.imagesContainer.innerHTML = '';\n\n  currentPage = 1;\n  showLoader();\n  const data = await getImages(query, currentPage);\n\n  if (!checkValidity(query, data.hits)) {\n    hideLoader();\n    return;\n  }\n\n  maxPage = Math.ceil(data.totalHits / pageSize);\n  renderImages(data.hits);\n  initializeSimpleLightbox();\n  hideLoader();\n  checkBtnStatus();\n  e.target.reset();\n}\n\nrefs.btnShowMore.addEventListener('click', onLoadMoreClick);\n\n\n// async function onLoadMoreClick() {\n//   currentPage += 1;\n//   showLoader();\n\n//   try {\n//     const data = await getImages(query, currentPage);\n//     renderImages(data.hits);\n    \n//     // Wait for images to be rendered before initializing SimpleLightbox\n//     await new Promise((resolve) => setTimeout(resolve, 0));\n//     initializeSimpleLightbox();\n//   } catch (err) {\n//     console.log(err);\n//   }\n\n//   hideLoader();\n//   checkBtnStatus();\n// }\n\nasync function onLoadMoreClick() {\n  currentPage += 1;\n  showLoader();\n\n  try {\n    const data = await getImages(query, currentPage);\n    renderImages(data.hits);\n    \n    // Wait for images to be rendered before initializing SimpleLightbox\n    await new Promise((resolve) => setTimeout(resolve, 0));\n    initializeSimpleLightbox();\n\n    if (currentPage >= maxPage) {\n      hideLoadMore();\n      iziToast.show({\n        color: 'green',\n        message: `Sorry, you have reached the end of collection.`,\n        position: 'topCenter',\n        timeout: 3000,\n      });\n    }\n  } catch (err) {\n    console.log(err);\n  }\n\n  hideLoader();\n  checkBtnStatus();\n}\nfunction checkValidity(query, hits) {\n  if (!query.trim()) {\n    iziToast.show({\n      color: 'black',\n      message: `Sorry, the input field must be filled in to start the photo search.`,\n      position: 'topCenter',\n      timeout: 3000,\n    });\n    return false;\n  } else if (hits.length === 0) {\n    iziToast.show({\n      color: 'red',\n      message: `Sorry, there are no images matching your search query. Please try again!`,\n      position: 'topCenter',\n      timeout: 3000,\n    });\n    return false;\n  }\n  return true;\n}\n\nfunction showLoadMore() {\n  refs.btnShowMore.classList.remove('hidden');\n}\n\nfunction hideLoadMore() {\n  refs.btnShowMore.classList.add('hidden');\n}\n\nfunction showLoader() {\n  refs.loader.classList.remove('hidden');\n}\n\nfunction hideLoader() {\n  refs.loader.classList.add('hidden');\n}\n\nfunction checkBtnStatus() {\n  if (currentPage >= maxPage) {\n    hideLoadMore();\n  } else {\n    showLoadMore();\n  }\n}\nfunction initializeSimpleLightbox() {\n  const simpleLightbox = new SimpleLightbox('.images a', {\n    captionPosition: 'bottom',\n    captionDelay: 250,\n    captionsData: 'alt',\n  });\n  simpleLightbox.refresh();\n}\n"],"names":["imageTemplate","obj","largeImageURL","webformatURL","tags","likes","views","comments","downloads","imagesTemplate","arr","renderImages","markup","refs","getImages","query","currentPage","url","params","axios","maxPage","pageSize","onFormSubmit","showLoader","data","checkValidity","hideLoader","initializeSimpleLightbox","checkBtnStatus","onLoadMoreClick","resolve","hideLoadMore","iziToast","err","hits","showLoadMore","SimpleLightbox"],"mappings":"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"}